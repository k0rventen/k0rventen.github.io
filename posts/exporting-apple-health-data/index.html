<!doctype html><html lang=en><head><title>Exporting Apple Health Data ::
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Example of metrics exported from Apple Health in Grafana: If you want to test the tool, check out the Github repo here
what &amp;amp; why Having a health tracker such as an apple watch is great, but the default views in the Health app on the iPhone can be too simplistic. We can&amp;rsquo;t correlate between metrics, define a specific time range, etc..
But it&amp;rsquo;s possible to export all of the collected health data in an archive."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/exporting-apple-health-data/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon.png><link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="Exporting Apple Health Data"><meta name=twitter:description content="Graph your health using grafana"><meta property="og:title" content="Exporting Apple Health Data"><meta property="og:description" content="Graph your health using grafana"><meta property="og:type" content="article"><meta property="og:url" content="/posts/exporting-apple-health-data/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-23T20:44:24+02:00"><meta property="article:modified_time" content="2022-08-23T20:44:24+02:00"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>k0rventen:~</span>
<span class=logo__cursor></span>
</a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/manpage>manpage</a></li><li><a href=/>posts</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/manpage>manpage</a></li><li><a href=/>posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>Exporting Apple Health Data</h1><div class=post-meta><span class=post-date>2022-08-23
</span><span class=post-read-time>— 2 min read</span></div><span class=post-tags><a href=/tags/apple/>#apple</a>&nbsp;
<a href=/tags/influx/>#influx</a>&nbsp;
<a href=/tags/python/>#python</a>&nbsp;
<a href=/tags/grafana/>#grafana</a>&nbsp;</span><div class=post-content><h2>Table of Contents</h2><aside class=table-of-contents><nav id=TableOfContents><ul><li><ul><li><a href=#what--why>what & why</a></li></ul></li><li><a href=#how>how</a><ul><li><a href=#architecture>Architecture</a></li><li><a href=#export-format>Export format</a></li><li><a href=#tips-on-analyzing-the-data>Tips on analyzing the data</a></li></ul></li></ul></nav></aside><p><em>Example of metrics exported from Apple Health in Grafana:</em>
<img src=https://github.com/k0rventen/apple-health-grafana/raw/main/example.png alt></p><p><strong>If you want to test the tool, check out the <a href=https://github.com/k0rventen/apple-health-grafana>Github repo here</a></strong></p><h2 id=what--why>what & why</h2><p>Having a health tracker such as an apple watch is great, but the default views in the Health app on the iPhone can be too simplistic. We can&rsquo;t correlate between metrics, define a specific time range, etc..</p><p>But it&rsquo;s possible to export all of the collected health data in an archive. The goal then is to parse this archive and import it in a more analysis friendly tool. I&rsquo;m most familiar with the InfluxDB+Grafana stack, so that&rsquo;s what I&rsquo;ll be using, but the parsing tool should provide a groundwork for parsing the exported data, and could be adapted to import to other tools.</p><h1 id=how>how</h1><h2 id=architecture>Architecture</h2><p>The tool is a 3 components docker-compose stack:</p><ul><li>a parsing container that will ingest our exported health data,</li><li>influxDB for storing the data</li><li>grafana to visualize</li></ul><h2 id=export-format>Export format</h2><p>From support.apple.com:</p><pre tabindex=0><code>Share your health and fitness data in XML format

You can export all of your health and fitness data from Health in XML format, which is a common format for sharing data between apps.

    Tap your profile picture or initials at the top right.

    If you don’t see your profile picture or initials, tap Summary or Browse at the bottom of the screen, then scroll to the top of the screen.

    Tap Export all health data, then choose a method for sharing your data.
</code></pre><p>This will create a .zip file that can be shared from the iPhone.</p><p>Once you&rsquo;ve copied/share the file to your computer, unzip it. You should have a <code>export.xml</code> file in there.
This file contains all the health records recorded by the Health app.</p><p>The format is as follow:
k</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Record</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;HKQuantityTypeIdentifierHeartRate&#34;</span> <span style=color:#a6e22e>sourceName=</span><span style=color:#e6db74>&#34;apple-watch&#34;</span> <span style=color:#a6e22e>sourceVersion=</span><span style=color:#e6db74>&#34;8.7&#34;</span> <span style=color:#a6e22e>device=</span><span style=color:#e6db74>&#34;&amp;lt;&amp;lt;HKDevice: 0x2803d9810&amp;gt;, name:Apple Watch, manufacturer:Apple Inc., model:Watch, hardware:Watch3,4, software:8.7&amp;gt;&#34;</span> <span style=color:#a6e22e>unit=</span><span style=color:#e6db74>&#34;count/min&#34;</span> <span style=color:#a6e22e>creationDate=</span><span style=color:#e6db74>&#34;2022-07-26 17:28:52 +0200&#34;</span> <span style=color:#a6e22e>startDate=</span><span style=color:#e6db74>&#34;2022-07-26 17:22:58 +0200&#34;</span> <span style=color:#a6e22e>endDate=</span><span style=color:#e6db74>&#34;2022-07-26 17:22:58 +0200&#34;</span> <span style=color:#a6e22e>value=</span><span style=color:#e6db74>&#34;73&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;MetadataEntry</span> <span style=color:#a6e22e>key=</span><span style=color:#e6db74>&#34;HKMetadataKeyHeartRateMotionContext&#34;</span> <span style=color:#a6e22e>value=</span><span style=color:#e6db74>&#34;0&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;/Record&gt;</span>
</span></span></code></pre></div><p>Each record contains at least a <code>type</code>, which is the category of the metric, <code>timestamps</code>, a <code>value</code> and a <code>unit</code>. We also have access to the tracker that recorded the metric.</p><p>The ingester iterates through all the records, parses the important fields, then yields a dict that can be used as a measurement for influx.</p><h2 id=tips-on-analyzing-the-data>Tips on analyzing the data</h2><p>Some metrics can be displayed <strong>as is</strong>, but others might need tweaking in the influx request:</p><ul><li>adjusting the time interval to 1d.</li><li>using <strong>sum()</strong> instead of <strong>mean()</strong> to aggregate the metrics for a given interval.</li></ul></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/kube-user/><span class=button__icon>←</span>
<span class=button__text>Add a new external user (or bot) in k8s</span>
</a></span><span class="button next"><a href=/posts/flask-gatekeeper/><span class=button__text>Gatekeeper, a ban & rate limit lib for flask</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>k0rventen:~</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2024 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>